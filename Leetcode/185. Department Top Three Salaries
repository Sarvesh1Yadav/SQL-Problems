# Write your MySQL query statement below
with cte as(
    select departmentId,salary,dense_rank() over (partition by departmentId  order by salary desc) as dr from Employee
)
select d.name as Department ,e.name as Employee,e.salary as Salary
from Employee e join Department d on d.id=e.departmentId 
where (e.departmentId,e.salary)  in (select departmentId,salary from cte where cte.dr<=3)
