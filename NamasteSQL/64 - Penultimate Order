SELECT order_id,order_date,
       customer_name,
       product_name,
       sales
FROM (
    SELECT *,
           ROW_NUMBER() OVER (
               PARTITION BY customer_name
               ORDER BY order_date DESC
           ) AS rn
    FROM orders
) t
WHERE rn = 2
   OR customer_name IN (
        SELECT customer_name
        FROM orders
        GROUP BY customer_name
        HAVING COUNT(*) = 1
   )
ORDER BY customer_name;
